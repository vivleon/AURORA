## 🖥️ Aurora UI & Consent 시스템 설계서
> 사용자 경험(UX)과 보안·동의(Consent-first) 체계를 통합한 UI 설계 문서

---

### 1️⃣ UI 구성 개요
Aurora의 UI는 **Edge WebView2** 또는 브라우저 기반 경량 Web UI로 동작하며, 다음 세 가지 핵심 컴포넌트로 구성된다.

| 구성요소 | 설명 |
|-----------|------|
| **Console Panel** | 사용자 입력 / AI 응답 인터페이스 (Chat 스타일) |
| **Consent Modal** | 동의 요청 팝업 (목적/범위/기간/대안 명시) |
| **Dashboard Panel** | 실행 로그, 성공률, Bandit 학습 현황, 정책 관리 |

---

### 2️⃣ 인터페이스 구조
```
+------------------------------------------------------------+
| Aurora AI Assistant (WebView2 / React)                     |
+------------------------------------------------------------+
| [Console Panel]                                            |
| > 사용자 입력: "회의 요약해서 메일로 보내줘"             |
| < AI 응답: "이 작업에는 메일 전송 권한이 필요합니다."      |
|   [동의하기] [거부하기]                                   |
|                                                            |
| [Consent Modal] (팝업)                                    |
| ┌────────────────────────────────────────────────────────┐ |
| | 작업명: 메일 발송(mail.send)                           | |
| | 목적: 회의 요약 전송                                   | |
| | 범위: 발신자 'user@domain.com'                         | |
| | 기간: 24시간 유효                                      | |
| | 대안: 초안만 생성 후 수동 발송 가능                    | |
| | ⚠️ High-risk 권한입니다. 동의 후 실행됩니다.            | |
| | [동의] [거부] [항상 허용(24h)]                          | |
| └────────────────────────────────────────────────────────┘ |
|                                                            |
| [Dashboard Panel]                                          |
| - 최근 실행 로그                                           |
| - 성공률 / 차단율 / P95 응답 시간                         |
| - Bandit 가중치 그래프                                    |
+------------------------------------------------------------+
```

---

### 3️⃣ Consent Modal 설계
| 항목 | 설명 |
|------|------|
| **작업명(Action)** | 실행하려는 Tool 이름 (예: mail.send) |
| **목적(Purpose)** | 사용자의 명령으로부터 자동 추출된 목적 요약 |
| **범위(Scope)** | 영향 범위 (파일/메일/시스템 등) |
| **기간(TTL)** | 동의 유효 기간 (1회, 세션, 24h 등) |
| **위험등급(Risk)** | Low / Medium / High 표시 |
| **대안(Alternative)** | 동일 기능을 제한적으로 수행할 대체 옵션 |
| **버튼** | [동의], [거부], [항상 허용] |

- **High-risk 동작 시 시각적 경고색(#FF5252)** 사용
- **로그 기록:** 사용자의 선택은 `audit.log`에 해시체인으로 저장

---

### 4️⃣ Dashboard 구성
- **요약지표:** 성공률(%), 차단율(%), 평균/최대 지연(ms)
- **Bandit-Lite 현황:** 툴별 가중치 그래프, 최근 업데이트 시점
- **정책 상태:** TTL 만료, 승인된 스코프, 보류 중 항목
- **최근 감사기록:** 동의/거부/실패 로그 트리뷰

---

### 5️⃣ 사용자 플로우 예시
#### 📘 시나리오: “회의록 요약해서 메일로 보내줘”
1. 사용자가 입력 → Planner가 intent: `mail.send`, risk: High 판단
2. Verifier가 policy.json 검증 → 동의 필요 판단
3. Consent Modal 팝업 → 사용자 선택
4. 사용자가 ‘동의’ 선택 → 정책 토큰 생성 및 TTL 기록
5. Executor가 메일 초안 생성 후 발송 수행
6. Dashboard에 결과와 로그 반영

---

### 6️⃣ 기술 스택 (UI)
- **Frontend:** React + TailwindCSS + shadcn/ui
- **State 관리:** Zustand (Consent 상태 및 정책 캐시)
- **차트:** Recharts (Bandit 가중치, KPI 시각화)
- **보안:** JWT 기반 세션, CSRF 보호, 로컬스토리지 암호화 (AES)

---

### 7️⃣ Consent 데이터 구조
```json
{
  "consent_id": "uuid",
  "action": "mail.send",
  "purpose": "회의 요약 전송",
  "scope": "mail",
  "ttl_hours": 24,
  "risk": "high",
  "decision": "approved",
  "timestamp": "2025-11-07T12:00:00Z",
  "hash_prev": "sha256(prev_log)"
}
```

---

### 8️⃣ UX 원칙
- **투명성:** 모든 작업의 목적·위험·대안 명시
- **최소주의:** 불필요한 권한 요청 금지
- **피드백성:** 동의 후 결과·로그를 즉시 표시
- **일관성:** 모든 Consent 팝업의 레이아웃 통일
- **안전성:** TTL 만료 후 자동 철회 및 로그 검증

---

### 9️⃣ 향후 확장 방향
- **음성 동의 지원:** TTS 안내 후 음성 ‘예/아니오’ 입력
- **다중 세션 정책 공유:** Federated Token 관리
- **동의 이력 분석:** 사용자 패턴 기반 위험등급 조정
- **Adaptive Consent:** 동일 상황 반복 시 신뢰도 기반 TTL 자동조정

---

### ✅ 결론
Aurora의 UI/Consent 시스템은 단순한 인터페이스가 아니라, **사용자 신뢰·보안·효율성을 통합 관리하는 핵심 허브**이다.  
이 구조를 통해 사용자는 모든 행동을 명확히 이해하고, AI는 윤리적이고 안전하게 진화할 수 있다.